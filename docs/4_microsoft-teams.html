<!-- ## Metadata_Start
## title: Microsoft Teams bot
## original-url : https://learn.torq.io/docs/microsoft-teams-bot
## article-id : 3c104160-d8f5-4c47-92fe-47b0acac6e2d
## seo-title : Microsoft Teams bot
## description : 
## category-type : html
## Metadata_End -->
<p><meta charset="utf-8"></p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">This tutorial demonstrates several useful Teams use cases to help you get started and give you ideas for how you can use Teams in your Torq workflows.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">First set up the available&nbsp;<a href="https://app.torq.io/integrations?filter=microsoft" rel="nofollow noopener noreferrer" style="box-sizing: border-box; color: rgb(134, 58, 181); text-decoration: none; background-color: transparent; user-select: auto;" target="_blank" translate="no">Microsoft integrations</a> required for these flows. Continue reading to get an idea of what you can do with them.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Team use cases covered in this tutorial:</p><ul style="box-sizing: border-box; margin: 0px 0px 15px 20px; list-style-position: inside; padding: 0px; color: rgb(34, 34, 34); list-style-type: disc; font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;">Trigger a Torq workflow by running a command in Teams</li><li style="box-sizing: border-box;">Send a message in Teams</li><li style="box-sizing: border-box;">Send a question using Teams (Basic)</li><li style="box-sizing: border-box;">Send a question using Teams (Advanced)</li></ul><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">The tutorial is based on an example workflow triggered when a user runs a command in Teams to investigate an IP address (or a list of addresses). The workflow loops over the IPs provided by the user, scans each IP with VirusTotal after getting the user confirmation, attempts to retrieve the analysis results, and offers to continue the investigation when relevant.</p><h2 style="box-sizing: border-box; margin: 32px 0px 12px; font-weight: 600; line-height: inherit; font-size: 1.75rem; font-family: &quot;Red Hat Display&quot;, sans-serif; padding: 0px; border: none; color: rgb(34, 34, 34); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Trigger a Torq workflow by running a command in Teams</h2><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">You can trigger Torq workflows without leaving Teams. Follow these instructions to set up a&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Teams-Bot command</strong> called&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">check-ip</strong>.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Once you've created the check-ip command, you can use it to trigger a Torq workflow from within Teams.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Create a webhook that waits for a message from the Teams-Bot and contains the check-ip string. When you run the check-ip command in any channel, the workflow will be triggered. You can add as many unique commands as you would like to trigger different workflows.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><br style="box-sizing: border-box;"></p><div class="fr-img-space-wrap" style="box-sizing: border-box; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image%28114%29.png" class="fr-fic fr-dii" alt="Screenshot of Microsoft Teams Bot trigger for the check-ip string" style="box-sizing: border-box; vertical-align: bottom; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: calc(100% - 10px); display: inline-block; float: none; margin-left: 5px; margin-right: 5px; width: 525px;">&nbsp;</div><p class="fr-img-space-wrap2" style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">&nbsp;</p><h2 style="box-sizing: border-box; margin: 32px 0px 12px; font-weight: 600; line-height: inherit; font-size: 1.75rem; font-family: &quot;Red Hat Display&quot;, sans-serif; padding: 0px; border: none; color: rgb(34, 34, 34); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Send a message in Teams</h2><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">You can use the&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Post Message in Conversation V2</strong> step in your Torq workflow to send a message to a Teams channel, or directly to a user.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Follow these instructions to set up a&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Teams integration</strong> to start using the steps in a Torq workflow.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">The example below shows how you can use information from the trigger event JSON to send a confirmation message. The step&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Post Message in Conversation V2</strong> was renamed to the meaningful&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Confirm Receipt of Command</strong>.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Use&nbsp;<code data-backticks="3" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 14px; color: rgb(232, 62, 140); overflow-wrap: break-word;">$.event.conversation.id</code> to send the message in the channel the workflow was triggered from (this will automatically respond to either the channel or user).</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">You can also use the&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">AUTO_INSTALL_BOT</strong> parameter to automatically install the Teams bot in the user or team channel to which you want to send the message, in the event that it has not yet been configured for that recipient. This will ensure that they are able to receive this, and future, messages.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image%28115%29.png" "=" " class="fr-fic fr-dii" alt="Screenshot from the Torq app of the Teams Bot step Confirm Receipt of Command" style="box-sizing: border-box; vertical-align: bottom; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: calc(100% - 10px); display: inline-block; float: none; margin-left: 5px; margin-right: 5px; width: 497px;"></p><h2 style="box-sizing: border-box; margin: 32px 0px 12px; font-weight: 600; line-height: inherit; font-size: 1.75rem; font-family: &quot;Red Hat Display&quot;, sans-serif; padding: 0px; border: none; color: rgb(34, 34, 34); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Send a question using Teams (Basic)</h2><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">You can use the Teams Bot&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Ask a Question</strong> step in your Torq workflow to send a message that contains a question and retains the user's response. The user response can be used to direct the rest of your workflow.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Let's return to the example workflow. You can loop over the IPs extracted from the check-ip command and confirm whether a VirusTotal scan is required for each one. The&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Ask a Question</strong> step in our example has been renamed to&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Scan IP addresses</strong>.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image%28116%29.png" class="fr-fic fr-dii" alt="Screenshot of the Torq app and the Teams Bot step Ask a Question, renamed to Scan IP addresses?" style="box-sizing: border-box; vertical-align: bottom; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: calc(100% - 10px); display: inline-block; float: none; margin-left: 5px; margin-right: 5px; width: 499px;"></p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">In our example, the verification is sent to the system administrator, but you can send it to any channel or user you would like.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">You need to provide the responses the user can choose from, and select if they are presented as buttons or drop-downs. Additionally, you can add a timeout for how long to wait for the user response, as well as a default response in the event the time limit is reached.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">The user response can be referenced by using&nbsp;<code data-backticks="3 " style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 14px; color: rgb(232, 62, 140); overflow-wrap: break-word;">$.scan_ip_addresses.selected_response</code>. If the user responds with&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Yes</strong>, the IP is scanned with VirusTotal.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image%28117%29.png" class="fr-fic fr-dii" alt="Screenshot of the Torq app and the If condition, rename to If User Selected to Scan IP address" style="box-sizing: border-box; vertical-align: bottom; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: calc(100% - 10px); display: inline-block; float: none; margin-left: 5px; margin-right: 5px; width: 500px;"></p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">If the VirusTotal scan returns no data or the IP is found to be harmless, the user is prompted with a message suggesting further investigation of the IP address using a different vendor. In our example, we used&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Adaptive Cards</strong>.</p><h2 style="box-sizing: border-box; margin: 32px 0px 12px; font-weight: 600; line-height: inherit; font-size: 1.75rem; font-family: &quot;Red Hat Display&quot;, sans-serif; padding: 0px; border: none; color: rgb(34, 34, 34); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Send a question using a Teams Adaptive Card (Advanced)</h2><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">The user is first asked if they would like to further investigate the IP address, using the&nbsp;<strong style="box-sizing: border-box; font-weight: 700;">Follow-up Question</strong>. If they select yes, they are then asked which vendors they would like to use for this additional check.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image%28118%29.png" class="fr-fic fr-dii" alt="Screenshot from the Torq app of the Microsoft Adaptive Card Form step" style="box-sizing: border-box; vertical-align: bottom; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: calc(100% - 10px); display: inline-block; float: none; margin-left: 5px; margin-right: 5px; width: 503px;"></p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">The Adaptive Card Form step returns the JSON response and can be referenced to determine how the workflow continues. In this example, we can see that the user has asked to check the IP address with two additional vendors.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image%28119%29.png" class="fr-fic fr-dii" alt="The JSON response returned by the Adaptive Card Form" style="box-sizing: border-box; vertical-align: bottom; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: calc(100% - 10px); display: inline-block; float: none; margin-left: 5px; margin-right: 5px; width: 466px;"></p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">The values of the selected vendors are passed to a nested workflow, which then checks the IP address in the background and returns the results to the main workflow.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">At the end of the workflow, the user receives a message with the final results indicating if the IP address is malicious or benign.</p><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image%28120%29.png" class="fr-fic fr-dii" alt="Screenshot from the Torq App of the Teams step Send a Message, saying The IP is Safe" style="box-sizing: border-box; vertical-align: bottom; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: calc(100% - 10px); display: inline-block; float: none; margin-left: 5px; margin-right: 5px; width: 567px;"></p>
